Based on chapter 9 of Practical Common Lisp book.
